<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
</head>

<body>
  <h1>Welcome to your notes</h1>
  <textarea id="newNote" rows = "3"cols = "80">Type your note in here</textarea>
  <!-- <input type="text" id="newNote"></input> -->
  <input type="submit" id="submit" value="Submit"></input>
  <p id = "notes"></p>
  <script src="./lib/note.js"></script>
  <script>
    document.getElementById("submit").addEventListener("click", function(clickEvent){
      clickEvent.preventDefault();
      createNewNote()
      printEachNote(Note.all()[Note.all().length - 1])
    });

    Note.all().forEach(printEachNote)

    function printEachNote(note, index){
      document.getElementById("notes").innerHTML += "<li>" + `<a href="#note${index}">` + note.text.substring(0,20) + "</a>" + "</li>" + "<br>";
    };

    function createNewNote(){
      new Note(document.getElementById("newNote").value);
    };

    makeUrlChangeShowNoteForCurrentPage();

    function makeUrlChangeShowNoteForCurrentPage() {
      window.addEventListener("hashchange", showNoteForCurrentPage);
    };

    function showNoteForCurrentPage() {
    showNote(getNoteFromUrl(window.location));
    };

    function getNoteFromUrl(location) {
    return location.hash.split("#")[1];
    };

    function showNote(note) {
      var index = note.split("note")[1];
      document.getElementById("notes").innerHTML = Note.all()[index].text;
      document.getElementById("notes").addEventListener("click",function(clickEvent){
        clickEvent.preventDefault();
        Note.all().forEach(printEachNote)
      });
    };

  </script>
</body>

</html>
