<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
</head>

<body>
  <h1>Welcome to your notes</h1>
  <textarea id="newNote" rows = "3"cols = "80">Type your note in here</textarea>
  <input type="submit" id="submit" value="Submit"></input>
  <p id = "notes"></p>
  <script src="./lib/note.js"></script>
  <script>
    document.getElementById("submit").addEventListener("click", function(clickEvent){
      clickEvent.preventDefault();
      createNewNote()
      printEachNote(Note.all()[Note.all().length - 1])
    });

    Note.all().forEach(printEachNote)

    function printEachNote(note){
      document.getElementById("notes").innerHTML += "<li>" + `<a href="#${note.id}">` + note.text.substring(0,20) + "</a>" + "</li>" + "<br>";
    };

    function createNewNote(){
      new Note(document.getElementById("newNote").value);
    };

    makeUrlChangeShowNoteForCurrentPage();

    function makeUrlChangeShowNoteForCurrentPage() {
      window.addEventListener("hashchange", showNoteForCurrentPage);
    };

    function showNoteForCurrentPage() {
      console.log(location.hash)
    showNote(getNoteFromUrl(window.location));
    };

    function getNoteFromUrl(location) {
    return location.hash.split("#")[1];
    };

    function showNote(note) {
      // document.getElementById("notes").innerHTML = '<a href="#">' + Note.all()[note].text + '</a>'
      document.getElementById("notes").innerHTML = Note.all()[note].text
      // notebook.get.text
      // var btn = document.createElement("BUTTON")
      // btn.innerHTML = "Go Back"
      // document.body.appendChild(btn);
      //   btn.addEventListener("click", function())
      document.getElementById("notes").addEventListener("click", function(clickEvent){
        clickEvent.preventDefault();
        // clear all content
        document.getElementById("notes").innerHTML = ""
        Note.all().forEach(printEachNote)})
    };

  </script>
</body>

</html>
